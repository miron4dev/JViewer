<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
        "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:composite="http://java.sun.com/jsf/composite"
      xmlns:p="http://primefaces.org/ui"
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

<composite:interface>
    <composite:attribute name="currentPage" required="true" type="tk.jviewer.info.state.CurrentPage"/>
</composite:interface>

<composite:implementation>

    <h:outputScript library="js" name="bootstrap.min.js"/>
    <h:outputStylesheet library="css" name="bootstrap.min.css"/>
    <h:outputStylesheet library="css" name="custom.css"/>

    <h:panelGroup id="navigation" layout="block" styleClass="navbar navbar-default navbar-fixed-top" role="navigation">
        <h:panelGroup layout="block" styleClass="container">
            <h:panelGroup layout="block" styleClass="navbar-collapse collapse">
                <ul class="nav navbar-nav">
                    <li><p:link styleClass="navbar-brand" outcome="index" value="JViewer"/></li>
                    <li class="#{cc.attrs.currentPage == 'MAIN' ? 'active': ''}"><p:link outcome="index" value="Главная"/></li>
                    <li class="#{cc.attrs.currentPage == 'NEWS' ? 'active': ''}"><p:link outcome="news" value="Новости"/></li>
                    <!--<li class="#{cc.attrs.currentPage == 'DOWNLOAD' ? 'active': ''}"><p:link outcome="download" value="Скачать"/></li>-->
                    <!--<li class="#{cc.attrs.currentPage == 'HOWTO' ? 'active': ''}"><p:link outcome="howto" value="Инструкция"/></li>-->
                    <li class="#{cc.attrs.currentPage == 'CONTACTS' ? 'active': ''}"><p:link outcome="contacts" value="Разработчик"/></li>
                    <c:if test="#{userProfile.authenticated}">
                        <li style="margin-left: 45px; margin-top: 23px">
                            <h:form>
                                <p:commandLink actionListener="#{loginController.logout}" value="Выйти" oncomplete="setTimeout(location.reload(), 1000)"/>
                            </h:form>
                        </li>
                    </c:if>
                    <c:if test="#{cc.attrs.currentPage == 'MAIN' and not userProfile.authenticated}">
                        <li>
                            <h:panelGroup layout="block" styleClass="alert alert-danger fade in" rendered="#{not empty flash.failed}"
                                 style="z-index: 1000; position: absolute; width: 500px; height: 50px; text-align: center;">
                                <button class="close" aria-hidden="true" data-dismiss="alert" type="button">×</button>
                                <h:outputText value="#{flash.failed}"/>
                            </h:panelGroup>
                        </li>
                        <li style="margin-top: 14px;">
                            <h:form styleClass="form-inline">
                                <p:inputText required="true" placeholder="Имя пользователя" style="padding: 5px"
                                    value="#{userProfile.name}"/>
                                <h:outputText value="&#160;" />
                                <p:password required="true" placeholder="Пароль" style="padding: 5px"
                                    value="#{userProfile.password}"/>
                                <h:outputText value="&#160;" />
                                <p:commandButton icon="ui-icon-person" value=" Войти" styleClass="btn btn-default"
                                    style="padding: 2px; vertical-align: inherit" actionListener="#{loginController.login}"
                                    update=":#{cc.id}:navigation"/>
                            </h:form>
                        </li>
                    </c:if>
                </ul>
            </h:panelGroup>
        </h:panelGroup>
    </h:panelGroup>

    <div class="container">

        <composite:insertChildren/>

        <div style="text-align: center;">
            Евгений Мироненко © <h:outputText value="#{currentYear}"><f:convertDateTime pattern="yyyy" type="date" /></h:outputText>
        </div>

    </div>
</composite:implementation>

</html>